<content type="text/html" title="Fix Transformation and Job Problems">
  <body>
    <div>
      <div class="pentaho-overview-hidden">
        <div id="section_1" class="mt-page-section"><span id="Overview"></span> 
          <h2 class="editable">Overview</h2>
          <p>Provides information on how to fix transformation and job issues.</p>
        </div>
      </div>
      <p>There are several common transformation and job problems that can be easily addressed.</p>
      <div class="body conbody"> <span id="s9770"></span> <span id="Report_Parameters_That_Include_Accented_Characters_Fail_to_Validate"></span> <span id="Report_Parameters_That_Include_Accented_Characters_Fail_to_Validate-9770"></span> 
        <h2>Report Parameters That Include Accented Characters Fail to Validate</h2>
        <div>
          <div class="body conbody">
            <p class="p">If you run a report that has parameters that include accented characters and you see an error message that says &quot;This parameter value is of an invalid value,&quot; then you must make the Tomcat server modification explained in
              <a class="xref"
              title="Documentation/5.1/0P0/170/030/010/000" rel="internal" href="#s9771">Modifying server.xml To Work With Accented Characters</a> .</p>
          </div>
          <div class="related-links">
            <ul class="ullinks">
              <li class="link ulchildlink"><strong><a title="Documentation/5.1/0P0/170/030/010/000" rel="internal" href="#s9771">Modifying server.xml To Work With Accented Characters</a> </strong> 
                <br />
              </li>
            </ul>
          </div>
        </div><span id="s9771"></span> <span id="Modifying_server.xml_To_Work_With_Accented_Characters"></span> <span id="Modifying_server.xml_To_Work_With_Accented_Characters-9771"></span> 
        <h2>Modifying server.xml To Work With Accented Characters</h2>
        <div>
          <div class="body taskbody">
            <div class="section prereq p">This procedure is only necessary if you plan to use character sets that include accents, such as Spanish and French.</div>
            <div class="section context">
              <p class="p">Follow the instructions below to implement accented character set support. Change the paths to match your configuration.</p>
            </div>
            <ol class="ol steps">
              <li class="li step"> <span class="ph cmd">Stop the Tomcat service.</span>  <pre class="pre codeblock">sudo /etc/init.d/tomcat stop</pre> </li>
              <li class="li step"> <span class="ph cmd">Open the <span class="ph filepath">/tomcat/server/conf/server.xml</span>  file with a text editor.</span> 
              </li>
              <li class="li step"> <span class="ph cmd">Locate each <strong class="ph b">Connector</strong>  node (typically there are four in a default Tomcat configuration) and add a <strong class="ph b">URIEncoding=&quot;UTF-8&quot; </strong>  parameter to it, as shown below:</span>                 <pre class="pre codeblock"><Connector URIEncoding=&quot;UTF-8&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
               connectionTimeout=&quot;20000&quot;
               redirectPort=&quot;8443&quot; /></pre> </li>
              <li class="li step"> <span class="ph cmd">Save and close the file, then restart the Tomcat service.</span>  <pre class="pre codeblock">sudo /etc/init.d/tomcat start</pre> </li>
            </ol>
          </div>
        </div>
        <div id="section_2" class="mt-page-section"><span id="Cannot_Execute_or_Modify_a_Transformation_or_Job"></span> 
          <h2 class="editable">Cannot Execute or Modify a Transformation or Job</h2>
          <p>If you cannot run, preview, debug, replay, verify, schedule, copy, export, or save a transformation or job, have an administrative user check if the role to which you are assigned has been
            <a title="Use Pentaho Security on the DI Server" rel="internal"
            href="http://help.pentaho.com/Documentation/5.1/0H0/070/010/030/000">granted execute permission</a> . &nbsp;Execute permission is needed to perform these tasks.</p>
        </div>
        <div id="section_3" class="mt-page-section"><span id="Action_Sequences_That_Call_PDI_Content_Won't_Run"></span> 
          <h2 class="editable">
            <span>Action Sequences That Call PDI Content Won't Run</span> 
          </h2>
          <div class="body conbody">
            <p class="p">If you've established a solution repository in&nbsp;PDI&nbsp;to store your jobs and transformations, and you attempt to use that stored&nbsp;PDI&nbsp;content in an action sequence on the BA Server, the action sequence will not execute. This
              is because the BA Server needs specific connection information for the Data Integration (DI) Server in order to retrieve the job or transformation.</p>
          </div>
        </div>
        <div id="section_4" class="mt-page-section"><span id="Kitchen_can't_read_KJBs_from_a_Zip_export"></span> 
          <h2 class="editable">
            <span>Kitchen can't read KJBs from a Zip export</span> 
          </h2>
          <div class="body conbody">
            <div class="note note"><span class="notetitle">Note:</span> &nbsp;This also applies to Pan and&nbsp;KTR&nbsp;files in Zip archives.</div>
            <p class="p">If you are trying to read a&nbsp;KJB&nbsp;file from a Zip export but are getting errors, you may have a syntax error in your Kitchen command. Zip files must be prefaced by a&nbsp;<strong class="ph b">!</strong> &nbsp;(exclamation mark) character.
              On Linux and other Unix-like operating systems, you must escape the exclamation mark with a backslash:&nbsp;<strong class="ph b">\!</strong> </p>
            <div class="example">
              <p class="p"><strong class="ph b">Windows:</strong> </p> <pre class="pre codeblock">
Kitchen.bat /file:&quot;zip:file:///C:/Pentaho/PDI Examples/Sandbox/linked_executable_job_and_transform.zip!Hourly_Stats_Job_Unix.kjb&quot;</pre>
              <p class="p"><strong class="ph b">Linux:</strong> </p> <pre class="pre codeblock">
./kitchen.sh -file:&quot;zip:file:////home/user/pentaho/pdi-ee/my_package/linked_executable_job_and_transform.zip\!Hourly_Stats_Job_Unix.kjb&quot;</pre>
              <div id="section_5" class="mt-page-section"><span id="Jobs_Scheduled_on_DI_Server_Cannot_Execute_Transformation_on_Remote_Carte_Server"></span> 
                <h2 class="editable">Jobs Scheduled on DI Server Cannot Execute Transformation on Remote Carte Server</h2>
              </div>
            </div>
          </div>
          <p class="p">You may see an error like this one when trying to schedule a job to run on a remote Carte server:</p>
          <div class="p"> <pre class="pre codeblock">
ERROR 11-05 09:33:06,031 - !UserRoleListDelegate.ERROR_0001_UNABLE_TO_INITIALIZE_USER_ROLE_LIST_WEBSVC!
                com.sun.xml.ws.client.ClientTransportException: The server sent HTTP status code 401: Unauthorized 
</pre> </div>
          <p class="p">To fix this, follow the instructions in
            <a class="xref" title="https://help.pentaho.com/Documentation/5.1/0P0/180/070#Execute_Scheduled_Jobs_on_a_Remote_Carte_Server" rel="internal" href="http://help.pentaho.com/Documentation/5.1/0P0/180/070#Execute_Scheduled_Jobs_on_a_Remote_Carte_Server">Execute Scheduled Jobs on a Remote Carte Server</a> .</p>
        </div>
      </div>
      <div id="section_6" class="mt-page-section"><span id="Execute_Scheduled_Jobs_on_a_Remote_Carte_Server"></span> 
        <h2 class="editable">
          <span>Execute Scheduled Jobs on a Remote Carte Server</span> 
        </h2>
        <div class="section context">
          <p class="p">Follow the instructions below if you need to schedule a job to run on a remote Carte server. Without making these configuration changes, you will be unable to remotely execute scheduled jobs.</p>
          <div class="note note"><span class="notetitle">Note:</span> &nbsp;This process is also required for using the DI Server as a load balancer in a dynamic Carte cluster.</div>
        </div>
        <ol class="pentaho-list-ordered">
          <li class="li step"><span class="ph cmd">Stop the DI Server and remote Carte server.</span> </li>
          <li class="li step"><span class="ph cmd">Copy the&nbsp;<strong class="ph b">repositories.xml</strong> &nbsp;file from the&nbsp;<span class="ph filepath">.kettle</span> &nbsp;directory on your workstation to the same location on your Carte slave.</span> &nbsp;Without
            this file, the Carte slave will be unable to connect to the DI Repository to retrieve&nbsp;PDI&nbsp;content.</li>
          <li class="li step"><span class="ph cmd">Open the&nbsp;<span class="ph filepath">/pentaho/server/data-integration-server/tomcat/webapps/pentaho-di/WEB-INF/web.xml</span> &nbsp;file with a text editor.</span> 
          </li>
          <li class="li step"><span class="ph cmd">Find the&nbsp;<strong class="ph b">Proxy Trusting Filter</strong> &nbsp;filter section, and add your Carte server's IP address to the&nbsp;<strong class="ph b">param-value</strong> &nbsp;element.</span> </li>
          <li class="li step"><span class="ph cmd">Uncomment&nbsp;the proxy trusting filter-mappings between the
 <!-- begin trust --> and
 <!-- end trust --> markers.</span> </li>
        </ol>
        <div class="related-links"> <pre class="pre codeblock li step">

  <!-- begin trust --> 
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/authorizationPolicy</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/roleBindingDao</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/userRoleListService</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/unifiedRepository</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/userRoleService</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/Scheduler</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>Proxy Trusting Filter</filter-name>
    <url-pattern>/webservices/repositorySync</url-pattern>
  </filter-mapping>

  <!-- end trust --></pre>
          <ol class="pentaho-list-ordered" start="6">
            <li class="li step"><span class="ph cmd">Save and close the file, then edit the&nbsp;<strong class="ph b">carte.sh</strong> &nbsp;or&nbsp;<strong class="ph b">Carte.bat</strong> &nbsp;startup script on the machine that runs your Carte server.</span> </li>
            <li class="li step"><span class="ph cmd">Add&nbsp;<strong class="ph b">-Dpentaho.repository.client.attemptTrust=true</strong> &nbsp;to the&nbsp;<strong class="ph b">java</strong> &nbsp;line at the bottom of the file.</span> </li>
            <li class="li step"><span class="ph cmd">Save and close the file.</span> </li>
            <li class="li step"><span class="ph cmd">Start your Carte and DI Server</span> </li>
          </ol>
          <p>You can now schedule a job to run on a remote Carte instance.</p>
        </div>
      </div>
    </div>
  </body>
  <body target="toc">
    <ol>
      <li> <a href="#Overview" rel="internal">Overview</a>  </li>
      <li> <a href="#Report_Parameters_That_Include_Accented_Characters_Fail_to_Validate" rel="internal">Report Parameters That Include Accented Characters Fail to Validate</a>  </li>
      <li> <a href="#Modifying_server.xml_To_Work_With_Accented_Characters" rel="internal">Modifying server.xml To Work With Accented Characters</a>  </li>
      <li> <a href="#Cannot_Execute_or_Modify_a_Transformation_or_Job" rel="internal">Cannot Execute or Modify a Transformation or Job</a>  </li>
      <li> <a href="#Action_Sequences_That_Call_PDI_Content_Won't_Run" rel="internal">Action Sequences That Call PDI Content Won't Run</a>  </li>
      <li> <a href="#Kitchen_can't_read_KJBs_from_a_Zip_export" rel="internal">Kitchen can't read KJBs from a Zip export</a>  </li>
      <li> <a href="#Jobs_Scheduled_on_DI_Server_Cannot_Execute_Transformation_on_Remote_Carte_Server" rel="internal">Jobs Scheduled on DI Server Cannot Execute Transformation on Remote Carte Server</a>  </li>
      <li> <a href="#Execute_Scheduled_Jobs_on_a_Remote_Carte_Server" rel="internal">Execute Scheduled Jobs on a Remote Carte Server</a>  </li>
    </ol>
  </body>
</content>