<content type="text/html" title="Using the Annotate Stream Step for SDR">
  <body>
    <div>
      <p style="visibility: visible;">The Annotate Stream step helps you refine your data for the Streamlined Data Refinery&nbsp;by creating measures, link dimensions, or attributes on stream field(s) which you specify. If you want, you can create multiple annotations on the same field.
        For example, you might want to create an average measure and a sum measure on the same field. You can also annotate multiple streams to modify the same data model. Additionally, you can create and add calculated measures to the data model.</p>
      <p style="visibility: visible;">The Annotate Stream modifies the default model produced from the
        <a rel="internal" title="Documentation/6.1/0N0/060/0B0/020/0A0" href="/Documentation/6.1/0N0/060/0B0/020/0A0">Build Model</a>  job entry.</p>
      <p style="text-align: center; visibility: visible;">
        <a class="thumb" title="SDRBasicWorkflow.png" rel="internal" href="http://help.pentaho.com/@api/deki/files/8113/SDRBasicWorkflow.png">
          <img alt="SDRBasicWorkflow.png" class="internal default" style="width: 604px; height: 56px;" width="604px" height="56px" src="http://help.pentaho.com/@api/deki/files/8113/SDRBasicWorkflow.png?size=bestfit&amp;width=604&amp;height=56&amp;revision=1"
          />
        </a> 
      </p>
      <p style="visibility: visible;">After you are done annotating your data model, you are ready to
        <a rel="internal" title="Documentation/6.1/0N0/060/0B0/020/0D0" href="/Documentation/6.1/0N0/060/0B0/020/0D0">publish</a>  it.</p>
      <div class="mt-page-section" id="section_2">
        <div id="section_1" class="mt-page-section"><span id="Using_the_Annotate_Stream_Step"></span> 
          <h2 class="editable">Using the Annotate Stream Step</h2>
          <p>You can create annotations in different ways. The annotation type which you create determines which properties are shown in the dialog box to complete that annotation. This task assumes you are in the Transformation canvas in Spoon.</p>
          <ol
          class="pentaho-list-ordered">
            <li>In the <strong>Design </strong> tab, click the <strong>Flow </strong> folder, and then double-click the <strong>Annotate Stream </strong> step. Alternatively, you can drag the step icon on to the transformation canvas.</li>
            </ol>
            <p style="text-align: center;">
              <img alt="AnnotateStreamIcon.PNG" class="internal default" style="width: 192px; height: 49px;" width="192px" height="49px" src="http://help.pentaho.com/@api/deki/files/8109/AnnotateStreamIcon.PNG?size=bestfit&amp;width=192&amp;height=49&amp;revision=1"
              />
            </p>
            <ol class="pentaho-list-ordered" start="2">
              <li>Double-click the <strong>Annotate Stream</strong>  icon to open the Annotate Stream dialog box.</li>
              <li>Enter a name for the step in the <strong>Step Name</strong>  field.</li>
              <li>Select if you want to save the step locally or if you want to share it.
                <ul>
                  <li><strong>Local: </strong> The annotations will be saved locally into the transformation.</li>
                  <li><strong>Shared: </strong> Allows you to select, create, or rename a
                    <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#To_Create_an_Annotation_Group_for_Sharing_with_Other_Users:" rel="internal" title="Annotate Stream (step)">shared group of annotations </a> for use by PDI users.</li>
                </ul>
              </li>
              <li>Optionally, enter a description for the annotations in the <strong>Description </strong> field.</li>
              <li>Select available fields for annotation.
                <ol>
                  <li>Click the <strong>Select Fields</strong>  button to open the Select Fields to Annotate dialog box.</li>
                  <li>Double-click the fields in the Available Fields list to add them to the Selected Fields list. Optionally, you can use the arrows to move one or more fields to the Selected Fields list.</li>
                  <li>When finished, click <strong>OK </strong> to close the dialog box. The selected fields now display in the Annotations table featuring the following columns:
                    <table border="1" cellpadding="1" cellspacing="1" style="width: 100%; table-layout: fixed;">
                      <tbody>
                        <tr>
                          <td style="width: 155px;"><strong>Column</strong> </td>
                          <td style="width: 471px;"><strong>Description</strong> </td>
                        </tr>
                        <tr>
                          <td style="width: 155px;">Field</td>
                          <td style="width: 471px;">Lists the names of the fields selected for annotation.</td>
                        </tr>
                        <tr>
                          <td style="width: 155px;">Model Action</td>
                          <td style="width: 471px;">Specifies which model action is being taken: Create Measure, Create Attribute, or Link Dimension.</td>
                        </tr>
                        <tr>
                          <td style="width: 155px;">Summary</td>
                          <td style="width: 471px;">Displays a summary of that specific annotation.</td>
                        </tr>
                      </tbody>
                    </table>
                  </li>
                </ol>
              </li>
              <li>Now you can annotate the selected fields.
                <ol>
                  <li>To annotate a field, double-click it in the Annotations section<strong>.&nbsp;</strong> The Annotate dialog box appears for the selected field. Optionally, you can select the field in the Annotations table and then click the <strong>Edit </strong> (pencil)
                    icon in the upper-right corner.</li>
                  <li>In the Actions field, click the drop-down arrow to select one of the following actions. (For help on selecting values, select the topic link beside each action.)
                    <ul>
                      <li>Create Measure. See
                        <a href="/Documentation/6.0/0N0/060/0B0/020/0B0/010" rel="internal" title="Creating Measures on a Column">Creating Measures on Stream Fields.</a> 
                      </li>
                      <li>Create Attribute. See
                        <a href="/Documentation/6.0/0N0/060/0B0/020/0B0/020" rel="internal" title="Creating Attributes">Creating Attributes</a> .</li>
                      <li>Link Dimension. See
                        <a href="/Documentation/6.0/0N0/060/0B0/020/0B0/030" rel="internal" title="Creating Link Dimensions">Creating Link Dimensions</a> .</li>
                    </ul>
                  </li>
                  <li>You can use the <strong>Previous </strong> and <strong>Next </strong> buttons to navigate through the fields. When finished, click <strong>OK </strong> to continue or <strong>Cancel </strong> to close the dialog box without saving your annotations.</li>
                </ol>
              </li>
            </ol>
            <p class="pentaho-note" style="margin-left: 40px; visibility: visible;">You can remove a field from the Annotations section by selecting it in the table and then clicking the <strong>Delete </strong> ('<strong>X</strong> ') icon in the upper-right corner.</p>
            <ol class="pentaho-list-ordered" start="8">
              <li>Optionally, you can create a calculated measure to add to the model.
                <ol>
                  <li>Click the <strong>Add Calculated Measure</strong>  button to open the Annotate dialog box.</li>
                  <li>Fill in the following fields:
                    <table border="1" cellpadding="1" cellspacing="1" style="width: 100%; table-layout: fixed;">
                      <tbody>
                        <tr>
                          <td style="width: 150px;"><strong>Field</strong> </td>
                          <td style="width: 476px;"><strong>Description</strong> </td>
                        </tr>
                        <tr>
                          <td style="width: 150px;">Measure Name</td>
                          <td style="width: 476px;">Enter the name of the calculated measure you are creating.</td>
                        </tr>
                        <tr>
                          <td style="width: 150px;">Format</td>
                          <td style="width: 476px;">Specify how you want your calculated measure to appear in a report. For example, to display the measure as a percentage, you would select <strong>'#.#%;(#.#%)'</strong> .</td>
                        </tr>
                        <tr>
                          <td style="width: 150px;">Formula</td>
                          <td style="width: 476px;">Enter the formula of your calculated measure. This is an MDX statement. For more information, see
                            <a title="Introduction to the Multidimensional Expression Language (MDX)" rel="internal" href="http://help.pentaho.com/Documentation/6.1/0N0/020/0B0/000">Introduction to the MDX</a> .</td>
                        </tr>
                        <tr>
                          <td style="width: 150px;">When calculating subtotals use this formula check box</td>
                          <td style="width: 476px;">Optionally, select this check box if you want this calculated measure to be used in calculations of subtotals in your reports.</td>
                        </tr>
                        <tr>
                          <td style="width: 150px;">Hide this calculated measure in the model</td>
                          <td style="width: 476px;">Optionally, select this check box if you want to hide this calculated measure in the data model. When selected, the calculated measure will be a part of the model, but will not be visible to users when the data source is opened
                            in Analyzer. This check box is useful for calculated measures needed to build a proper data model, but not needed for analytic purposes.</td>
                        </tr>
                      </tbody>
                    </table>
                  </li>
                  <li>Use the <strong>Previous </strong> and <strong>Next </strong> buttons to navigate through the fields. When finished, click <strong>OK </strong> to add the attribute to the annotations list or <strong>Cancel </strong> to close the dialog
                    box without saving your annotations. The calculated measure displays in the Annotation table with the Model Action 'Create Calculated Measure' and a summary detailing the measure name and formula.</li>
                </ol>
              </li>
            </ol>
            <p class="pentaho-note" style="margin-left: 40px; visibility: visible;">The calculated measure is not validated until it is selected in Analyzer. Calculated measures will display as base measures in the Available Fields list in Analyzer, but cannot be modified by the user.</p>
            <ol class="pentaho-list-ordered"
            start="9">
              <li>Click <strong>Apply </strong> to save your changes. You can continue to create or edit annotations. When finished, click <strong>OK </strong> to save your changes and close the dialog box, or <strong>Cancel </strong> to discard your changes
                and close the dialog box.</li>
            </ol>
            <p style="text-align: center; visibility: visible;">
              <img alt="AnnotateStreamLocal.png" class="internal default" style="width: 719px; height: 536px;" width="719px" height="536px" src="http://help.pentaho.com/@api/deki/files/8110/AnnotateStreamLocal.png?size=bestfit&amp;width=719&amp;height=536&amp;revision=1"
              />
            </p>
        </div>
      </div>
      <div class="mt-page-section" id="section_3">
        <div id="section_2" class="mt-page-section"><span id="Creating_Annotation_Groups"></span> 
          <h2 style="visibility: visible;" class="editable">
            <span>Creating Annotation Groups</span> 
          </h2>
          <p style="visibility: visible;"><strong>Annotation groups</strong>  are useful when data sources, such as a weblog table, are reused in many transformations. Whenever this table is used, you can link to the shared annotation group to get model information on each table field.&nbsp;
            If the table were to ever change, then the annotations would only need to be updated in one place.</p>
          <p style="visibility: visible;">You can create multiple annotations based on the same annotation group by copying the group, and then saving it with a different name. You can do this as many times as you need to make a series of related annotation groups, such as annotations
            for time dimensions.</p>
          <p style="visibility: visible;">You must create a group to save your annotations. This group can be saved as just a local group or as a shared group. When the group is saved
            <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#To_Create_an_Annotation_Group_Locally:" rel="internal"
            title="Annotate Stream (step)">locally</a>, it is saved to the transformation on your machine. When you select 'Shared', it will also be stored in the metastore and available to other users.</p>
          <div class="mt-page-section" id="section_4">
            <div id="section_3" class="mt-page-section"><span id="To_Create_an_Annotation_Group_for_Sharing_with_Other_Users:"></span> 
              <h5 class="editable">To Create an Annotation Group for Sharing with Other Users:</h5>
              <p>If you want to share your annotation group with other users, select the <strong>Shared </strong> button and ensure the annotation group has a unique name. Once you click <strong>Apply</strong>, the group will be available to other users for
                creating PDI jobs by selecting from the <strong>Shared </strong> menu in the Annotate Stream step.</p>
              <p>This task assumes you are in the Transformation canvas in Spoon.</p>
              <ol class="pentaho-list-ordered">
                <li>Complete steps 1-3 in the
                  <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#Using_the_Annotate_Stream_Step" rel="internal" title="Annotate Stream (step)">Using the Annotate Stream Step</a> .</li>
                <li>Select the <strong>Shared </strong> radio button, then click on the <strong>Add Annotation Group</strong>  (&quot;<strong>+</strong> &quot; plus sign) icon next to the drop-down field.</li>
                <li>Enter a name for your annotation group in the Shared field, and then click <strong>Select Fields </strong> to begin creating annotations to populate the group. See steps 6-8 in
                  <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#Using_the_Annotate_Stream_Step"
                  rel="internal" title="Annotate Stream (step)">Using the Annotate Stream Step </a> for more information on selecting and annotating fields.</li>
              </ol>
              <p style="text-align: center; visibility: visible;">
                <a class="thumb" title="AnnotationGroupExample.png" rel="internal" href="http://help.pentaho.com/@api/deki/files/8112/AnnotationGroupExample.png">
                  <img alt="AnnotationGroupExample.png" class="internal default" style="width: 550px; height: 413px;" width="550px" height="413px" src="http://help.pentaho.com/@api/deki/files/8112/AnnotationGroupExample.png?size=bestfit&amp;width=550&amp;height=413&amp;revision=1"
                  />
                </a> 
              </p>
              <ol class="pentaho-list-ordered" start="4">
                <li>When you are done, click <strong>Apply</strong>  to save your annotations.</li>
              </ol>
            </div>
          </div>
          <div class="mt-page-section" id="section_5">
            <div id="section_4" class="mt-page-section"><span id="To_Create_an_Annotation_Group_Locally:"></span> 
              <h5 class="editable">To Create an Annotation Group Locally:</h5>
              <ol class="pentaho-list-ordered">
                <li>Complete steps 1-3 in
                  <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#Using_the_Annotate_Stream_Step" rel="internal" title="Annotate Stream (step)">Using the Annotate Stream Step</a> .</li>
                <li>Select the <strong>Local </strong> radio button. Your annotation group will only be saved into your transformation. Any user running this transformation can see and use the annotations group.</li>
                <li>Click <strong>Select Fields </strong> to begin creating annotations to populate the group. See steps 6-8 in
                  <a href="/Documentation/6.0/0N0/060/0B0/020/0B0#Using_the_Annotate_Stream_Step" rel="internal" title="Annotate Stream (step)">Using the Annotate Stream Step </a> for more information on selecting and annotating fields.</li>
                <li>When you are done, click <strong>Apply</strong>  to save your annotation group locally.</li>
              </ol>
              <p class="pentaho-note" style="visibility: visible;">If you later decide that you want to share the annotation group, you can reopen it and select the <strong>Shared</strong>  radio button, then click <strong>Apply</strong> . The group will then be shared to the metastore and be available to
                other users.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <body target="toc">
    <ol>
      <li> <a href="#Using_the_Annotate_Stream_Step" rel="internal">Using the Annotate Stream Step</a>  </li>
      <li>
        <a href="#Creating_Annotation_Groups" rel="internal">Creating Annotation Groups</a> 
        <ol>
          <li> <a href="#To_Create_an_Annotation_Group_for_Sharing_with_Other_Users:" rel="internal">To Create an Annotation Group for Sharing with Other Users:</a>  </li>
          <li> <a href="#To_Create_an_Annotation_Group_Locally:" rel="internal">To Create an Annotation Group Locally:</a>  </li>
        </ol>
      </li>
    </ol>
  </body>
</content>